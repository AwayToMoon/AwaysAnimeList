<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aways Anime List</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="app">
    <!-- Live Status -->
    <div id="live-status" class="live-status" style="display: none;">
      <div class="live-indicator">
        <div class="live-dot"></div>
        <span class="live-text">LIVE</span>
      </div>
      <div class="live-anime">
        <img id="live-cover" src="" alt="" class="live-cover">
        <div class="live-info">
          <h3 id="live-title">Anime Name</h3>
          <p class="live-platform">Aniworld</p>
        </div>
      </div>
    </div>

    <header class="header">
      <h1>Aways Anime List</h1>
      <div class="stats">
        <div class="stat-item">
          <span class="stat-number" id="total-count">0</span>
          <span class="stat-label">Gesamt</span>
        </div>
        <div class="stat-item">
          <span class="stat-number" id="watched-count">0</span>
          <span class="stat-label">Angeschaut</span>
        </div>
        <div class="stat-item">
          <span class="stat-number" id="plan-count">0</span>
          <span class="stat-label">Geplant</span>
        </div>
        <div class="stat-item">
          <span class="stat-number" id="waiting-count">0</span>
          <span class="stat-label">Warten</span>
        </div>
        <div class="stat-item">
          <span class="stat-number" id="fsk-count">0</span>
          <span class="stat-label">FSK16/18+</span>
        </div>
      </div>
      <div class="header-actions">
        <button id="backup-btn" class="btn backup" aria-label="Backup erstellen" title="Backup erstellen">üíæ Backup</button>
        <button id="restore-btn" class="btn restore" aria-label="Backup wiederherstellen" title="Backup wiederherstellen">üìÅ Wiederherstellen</button>
        <button id="theme-toggle" class="btn theme" aria-label="Theme wechseln" title="Theme wechseln">üåô</button>
        <button id="admin-toggle" class="btn admin" aria-label="Admin anmelden" title="Admin anmelden">üîí Admin</button>
      </div>
    </header>


    <section class="add-form">
      <form id="anime-form" autocomplete="off">
        <div class="field-group">
          <input id="anime-input" type="text" placeholder="Anime-Name eingeben..." required>
          <select id="anime-list-select" aria-label="Liste w√§hlen">
            <option value="plan">Noch am anschauen</option>
            <option value="watched">Fertig Geschaut</option>
            <option value="waiting">Warten auf Fortsetzung</option>
            <option value="fsk">FSK16/18+</option>
          </select>
          <button type="submit" class="btn primary">Hinzuf√ºgen</button>
        </div>
        <small class="hint">Nur Admins k√∂nnen hinzuf√ºgen.</small>
      </form>
      <div id="message" role="status" aria-live="polite"></div>
    </section>

    <nav class="tabs" role="tablist">
      <button class="tab active" role="tab" aria-selected="true" data-tab="plan">Noch am anschauen</button>
      <button class="tab" role="tab" aria-selected="false" data-tab="watched">Fertig Geschaut</button>
      <button class="tab" role="tab" aria-selected="false" data-tab="waiting">Warten auf Fortsetzung</button>
      <button class="tab" role="tab" aria-selected="false" data-tab="fsk">FSK16/18+</button>
    </nav>

    <main class="content">
      <section id="tab-plan" class="tab-panel active" role="tabpanel" aria-label="Noch am anschauen">
        <div id="grid-plan" class="grid"></div>
      </section>
      <section id="tab-watched" class="tab-panel" role="tabpanel" aria-label="Fertig Geschaut">
        <div id="grid-watched" class="grid"></div>
      </section>
      <section id="tab-waiting" class="tab-panel" role="tabpanel" aria-label="Warten auf Fortsetzung">
        <div id="grid-waiting" class="grid"></div>
      </section>
      <section id="tab-fsk" class="tab-panel" role="tabpanel" aria-label="FSK16/18+">
        <div id="grid-fsk" class="grid"></div>
      </section>
    </main>

    <footer class="footer">
    </footer>
  </div>

  <!-- Edit Modal -->
  <div id="edit-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Titel bearbeiten</h3>
        <button class="modal-close" aria-label="Schlie√üen">&times;</button>
      </div>
      <div class="modal-body">
        <div class="modal-cover">
          <img id="modal-cover-img" src="" alt="" class="modal-cover-image">
        </div>
        <div class="modal-form">
          <div class="modal-field">
            <label for="modal-title-input">Anime-Titel:</label>
            <input type="text" id="modal-title-input" placeholder="Titel eingeben...">
          </div>
          <div class="modal-field">
            <label for="modal-link-input">Link (optional):</label>
            <input type="url" id="modal-link-input" placeholder="https://myanimelist.net/anime/...">
          </div>
          <div class="modal-actions">
            <button type="button" class="btn secondary" id="modal-cancel">Abbrechen</button>
            <button type="button" class="btn primary" id="modal-save">Speichern</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Admin Modal -->
  <div id="admin-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Admin-Anmeldung</h3>
        <button class="modal-close" data-close-admin aria-label="Schlie√üen">&times;</button>
      </div>
      <div class="modal-body">
        <div class="modal-form" style="width:100%">
          <label for="admin-password">Passwort:</label>
          <input type="password" id="admin-password" placeholder="Admin-Passwort">
          <div class="modal-actions">
            <button type="button" class="btn secondary" id="admin-cancel">Abbrechen</button>
            <button type="button" class="btn primary" id="admin-login">Anmelden</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Restore Modal -->
  <div id="restore-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Backup wiederherstellen</h3>
        <button class="modal-close" data-close-restore aria-label="Schlie√üen">&times;</button>
      </div>
      <div class="modal-body">
        <div class="modal-form" style="width:100%">
          <label for="backup-file">Backup-Datei ausw√§hlen:</label>
          <input type="file" id="backup-file" accept=".json" style="margin-bottom: 16px;">
          <div class="modal-actions">
            <button type="button" class="btn secondary" id="restore-cancel">Abbrechen</button>
            <button type="button" class="btn primary" id="restore-confirm">Wiederherstellen</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Rating Modal -->
  <div id="rating-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Anime bewerten</h3>
        <button class="modal-close" data-close-rating aria-label="Schlie√üen">&times;</button>
      </div>
      <div class="modal-body">
        <div class="modal-form" style="width:100%">
          <div class="rating-container">
            <div class="stars" id="rating-stars">
              <span class="star" data-rating="1">‚≠ê</span>
              <span class="star" data-rating="2">‚≠ê</span>
              <span class="star" data-rating="3">‚≠ê</span>
              <span class="star" data-rating="4">‚≠ê</span>
              <span class="star" data-rating="5">‚≠ê</span>
              <span class="star" data-rating="6">‚≠ê</span>
              <span class="star" data-rating="7">‚≠ê</span>
              <span class="star" data-rating="8">‚≠ê</span>
              <span class="star" data-rating="9">‚≠ê</span>
              <span class="star" data-rating="10">‚≠ê</span>
            </div>
            <div class="rating-text" id="rating-text">Bewertung ausw√§hlen</div>
          </div>
          <div class="modal-field">
            <label for="rating-review">Review (optional):</label>
            <textarea id="rating-review" placeholder="Deine Meinung zu diesem Anime..." rows="3"></textarea>
          </div>
          <div class="modal-actions">
            <button type="button" class="btn secondary" id="rating-cancel">Abbrechen</button>
            <button type="button" class="btn danger" id="rating-remove" style="display: none;">Bewertung entfernen</button>
            <button type="button" class="btn primary" id="rating-save">Speichern</button>
          </div>
        </div>
      </div>
    </div>
  </div>



  <!-- Termin Modal -->
  <div id="termin-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Termin f√ºr Fortsetzung</h3>
        <button class="modal-close" data-close-termin aria-label="Schlie√üen">&times;</button>
      </div>
      <div class="modal-body">
        <div class="modal-form" style="width:100%">
          <div class="modal-field">
            <label for="termin-type">Status:</label>
            <select id="termin-type" style="margin-bottom: 16px;">
              <option value="date">üìÖ Mit Datum</option>
              <option value="tba">‚ùì TBA (To Be Announced)</option>
            </select>
          </div>
          <div class="modal-field" id="date-fields">
            <label for="termin-date">Datum der n√§chsten Folge:</label>
            <input type="date" id="termin-date" placeholder="Datum ausw√§hlen...">
          </div>
          <div class="modal-field" id="time-field">
            <label for="termin-time">Uhrzeit (optional):</label>
            <input type="time" id="termin-time" placeholder="Uhrzeit ausw√§hlen...">
          </div>
          <div class="modal-field">
            <label for="termin-note">Notiz (optional):</label>
            <input type="text" id="termin-note" placeholder="z.B. 'Episode 12', 'Staffel 2', 'Wird bekannt gegeben'...">
          </div>
          <div class="modal-actions">
            <button type="button" class="btn secondary" id="termin-cancel">Abbrechen</button>
            <button type="button" class="btn danger" id="termin-remove" style="display: none;">Termin entfernen</button>
            <button type="button" class="btn primary" id="termin-save">Speichern</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  
  <script>
    // Firebase Configuration (verschl√ºsselt)
    const encryptedConfig = "U2FsdGVkX1/2h2jz/okQRoolhPVQPafedlkbIfYoDr/bEIj6Qe4Gz4D+GJsaaQ5i7XVMwWJ+cqe94PGWRSvfQKwZHwpHdIr9YhzTEVGwzq0yCkU/7ZsA1fNW0THeJjRP5W+tborqv2W5F8pHhVoVtYy104eDojx6YeaaKd4zyAr36a1eAY82nlgIUMhzbl8s7LEWqoqk/w+4brkq8Gt7zZ2zkCij2mwXb8LEyZJBFSa0j62QdI8cKkSwBRw3MxO56KTu4tLFcbv7hhehDtKwM0PNJMkuDp+xldtmmvIOS56fR64kvsLXlkN/DSV+3MHLWFCHv/ry06NtgMy6aEz3mfFQUqP0uaTR+ohi3niWSNYJ+wMNgQsV6xiXj+VmKleN";
    
    function initFirebase() {
      const secretKey = "HigherCellF-Games-2024";
      const decrypted = CryptoJS.AES.decrypt(encryptedConfig, secretKey).toString(CryptoJS.enc.Utf8);
      const firebaseConfig = JSON.parse(decrypted);
      
      firebase.initializeApp(firebaseConfig);
      window.db = firebase.firestore();
    }

    initFirebase();
  </script>
  
  <script src="script.js"></script>
</body>
</html>
